-- ============================================
-- SEED SAMPLE LISTINGS - PART 1A (Categories 1-3)
-- ============================================

DO $$
DECLARE
    v_owner_id UUID;
    v_sub_id UUID;
BEGIN
    -- Get specific owner ID for testing (1kihiupaul@gmail.com)
    SELECT id INTO v_owner_id FROM public.user_profiles WHERE email = '1kihiupaul@gmail.com' LIMIT 1;
    
    -- Fallback: Get any owner if specific user not found
    IF v_owner_id IS NULL THEN
        SELECT id INTO v_owner_id FROM public.user_profiles WHERE role = 'owner' LIMIT 1;
    END IF;
    
    -- Fallback: Get any user if no owner found
    IF v_owner_id IS NULL THEN
        SELECT id INTO v_owner_id FROM public.user_profiles LIMIT 1;
    END IF;

    IF v_owner_id IS NOT NULL THEN
        
        -- 1. VEHICLES
        INSERT INTO public.listings (owner_id, category_id, subcategory_id, title, slug, description, price_per_day, images, status, location) VALUES
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'cars' LIMIT 1), 'Toyota Prado TX', 'toyota-prado-tx-' || substring(md5(random()::text) from 1 for 6), 'Reliable 4x4 for your safari adventures.', 8000, ARRAY['https://images.unsplash.com/photo-1533473359331-0135ef1b58bf?auto=format&fit=crop&q=80&w=800'], 'approved', 'Westlands, Nairobi'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'cars' LIMIT 1), 'Mazda Demio 2018', 'mazda-demio-2018-' || substring(md5(random()::text) from 1 for 6), 'Fuel efficient compact car perfect for city driving.', 2500, ARRAY['https://images.unsplash.com/photo-1549317661-bd32c8ce0db2?auto=format&fit=crop&q=80&w=800'], 'approved', 'Kilimani, Nairobi'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'cars' LIMIT 1), 'Subaru Forester', 'subaru-forester-' || substring(md5(random()::text) from 1 for 6), 'AWD SUV great for weekend getaways.', 4500, ARRAY['https://images.unsplash.com/photo-1626248906645-562a98e8f815?auto=format&fit=crop&q=80&w=800'], 'approved', 'CBD, Nakuru'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'luxury-cars' LIMIT 1), 'Range Rover Sport', 'range-rover-sport-' || substring(md5(random()::text) from 1 for 6), 'Luxury SUV for weddings and special occasions.', 25000, ARRAY['https://images.unsplash.com/photo-1606226343588-446700c01d4a?auto=format&fit=crop&q=80&w=800'], 'approved', 'Karen, Nairobi'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'vans' LIMIT 1), 'Toyota Hiace Van', 'toyota-hiace-' || substring(md5(random()::text) from 1 for 6), '14-seater van for group travel.', 6000, ARRAY['https://images.unsplash.com/photo-1625055627237-70eb3e0b821c?auto=format&fit=crop&q=80&w=800'], 'approved', 'Nyali, Mombasa'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'cars' LIMIT 1), 'Honda Fit', 'honda-fit-' || substring(md5(random()::text) from 1 for 6), 'Compact and economical.', 2200, ARRAY['https://images.unsplash.com/photo-1590362835106-132df7378fc7?auto=format&fit=crop&q=80&w=800'], 'approved', 'South B, Nairobi'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'luxury-cars' LIMIT 1), 'Mercedes C-Class', 'mercedes-c-class-' || substring(md5(random()::text) from 1 for 6), 'Executive sedan for business meetings.', 12000, ARRAY['https://images.unsplash.com/photo-1617788138017-80ad40651399?auto=format&fit=crop&q=80&w=800'], 'approved', 'Lavington, Nairobi'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'motorcycles' LIMIT 1), 'Yamaha R6 Bike', 'yamaha-r6-' || substring(md5(random()::text) from 1 for 6), 'High performance sport bike.', 5000, ARRAY['https://images.unsplash.com/photo-1568772585407-9361f9bf3a87?auto=format&fit=crop&q=80&w=800'], 'approved', 'Westlands, Nairobi'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'trucks' LIMIT 1), 'Ford Ranger', 'ford-ranger-' || substring(md5(random()::text) from 1 for 6), 'Double cab pickup for heavy duty tasks.', 7000, ARRAY['https://images.unsplash.com/photo-1619762140669-9df8c2b74052?auto=format&fit=crop&q=80&w=800'], 'approved', 'Milimani, Kisumu'),
        (v_owner_id, '11111111-1111-1111-1111-111111111111', (SELECT id FROM public.subcategories WHERE slug = 'cars' LIMIT 1), 'Toyota Vitz', 'toyota-vitz-' || substring(md5(random()::text) from 1 for 6), 'Small city runner.', 2000, ARRAY['https://images.unsplash.com/photo-1616455171720-3b6d22dcc9c4?auto=format&fit=crop&q=80&w=800'], 'approved', 'Kasarani, Nairobi');

        -- 2. HOMES & APARTMENTS
        INSERT INTO public.listings (owner_id, category_id, subcategory_id, title, slug, description, price_per_day, images, status, location) VALUES
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'apartments' LIMIT 1), 'Modern 2BR Apartment', 'modern-2br-apt-' || substring(md5(random()::text) from 1 for 6), 'Fully furnished apartment with pool access.', 4500, ARRAY['https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?auto=format&fit=crop&q=80&w=800'], 'approved', 'Kilimani, Nairobi'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'apartments' LIMIT 1), 'Cozy Studio', 'cozy-studio-' || substring(md5(random()::text) from 1 for 6), 'Perfect for solo travelers.', 2500, ARRAY['https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?auto=format&fit=crop&q=80&w=800'], 'approved', 'Westlands, Nairobi'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'villas' LIMIT 1), 'Beachfront Villa', 'beachfront-villa-' || substring(md5(random()::text) from 1 for 6), 'Luxurious villa with ocean view.', 15000, ARRAY['https://images.unsplash.com/photo-1499793983690-e29da59ef1c2?auto=format&fit=crop&q=80&w=800'], 'approved', 'Diani, Mombasa'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'cottages' LIMIT 1), 'Garden Cottage', 'garden-cottage-' || substring(md5(random()::text) from 1 for 6), 'Quiet retreat in a lush garden.', 3500, ARRAY['https://images.unsplash.com/photo-1583608205776-bfd35f0d9f83?auto=format&fit=crop&q=80&w=800'], 'approved', 'Karen, Nairobi'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'apartments' LIMIT 1), 'City Center Loft', 'city-loft-' || substring(md5(random()::text) from 1 for 6), 'Stylish loft in the heart of CBD.', 4000, ARRAY['https://images.unsplash.com/photo-1505691938895-1758d7feb511?auto=format&fit=crop&q=80&w=800'], 'approved', 'CBD, Nairobi'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'cottages' LIMIT 1), 'Safari Lodge Room', 'safari-lodge-' || substring(md5(random()::text) from 1 for 6), 'Experience nature near National Park.', 8000, ARRAY['https://images.unsplash.com/photo-1590523277543-a94d2e4eb00b?auto=format&fit=crop&q=80&w=800'], 'approved', 'Langata, Nairobi'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'apartments' LIMIT 1), '3BR Family House', '3br-family-house-' || substring(md5(random()::text) from 1 for 6), 'Spacious house ideal for families.', 6000, ARRAY['https://images.unsplash.com/photo-1564013799919-ab600027ffc6?auto=format&fit=crop&q=80&w=800'], 'approved', 'Elgon View, Eldoret'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'villas' LIMIT 1), 'Penthouse Suite', 'penthouse-suite-' || substring(md5(random()::text) from 1 for 6), 'Luxury living with panoramic views.', 20000, ARRAY['https://images.unsplash.com/photo-1512918760383-eda2723ad6e1?auto=format&fit=crop&q=80&w=800'], 'approved', 'Kileleshwa, Nairobi'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'shared-rooms' LIMIT 1), 'Budget Guest Room', 'budget-guest-room-' || substring(md5(random()::text) from 1 for 6), 'Affordable accommodation.', 1500, ARRAY['https://images.unsplash.com/photo-1520277739336-7bf67edfa6c4?auto=format&fit=crop&q=80&w=800'], 'approved', 'Milimani, Kisumu'),
        (v_owner_id, '22222222-2222-2222-2222-222222222222', (SELECT id FROM public.subcategories WHERE slug = 'apartments' LIMIT 1), 'Serviced Apartment', 'serviced-apt-' || substring(md5(random()::text) from 1 for 6), 'Daily cleaning and breakfast included.', 5500, ARRAY['https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?auto=format&fit=crop&q=80&w=800'], 'approved', 'Lavington, Nairobi');

        -- 3. EQUIPMENT & TOOLS
        INSERT INTO public.listings (owner_id, category_id, subcategory_id, title, slug, description, price_per_day, images, status, location) VALUES
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'power-tools' LIMIT 1), 'Power Drill Set', 'power-drill-' || substring(md5(random()::text) from 1 for 6), 'Bosch power drill usage.', 500, ARRAY['https://images.unsplash.com/photo-1504148455328-c376907d081c?auto=format&fit=crop&q=80&w=800'], 'approved', 'Industrial Area, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'construction' LIMIT 1), 'Portable Generator', 'generator-' || substring(md5(random()::text) from 1 for 6), '5kVA petrol generator.', 2000, ARRAY['https://images.unsplash.com/photo-1581092580497-e0d23cbdf1dc?auto=format&fit=crop&q=80&w=800'], 'approved', 'Thika Road, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'ladders' LIMIT 1), 'Ladder 10ft', 'ladder-10ft-' || substring(md5(random()::text) from 1 for 6), 'Heavy duty aluminum ladder.', 300, ARRAY['https://images.unsplash.com/photo-1586864387967-d02ef85d93e8?auto=format&fit=crop&q=80&w=800'], 'approved', 'Eastleigh, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'cleaning' LIMIT 1), 'Pressure Washer', 'pressure-washer-' || substring(md5(random()::text) from 1 for 6), 'High pressure car washer.', 800, ARRAY['https://images.unsplash.com/photo-1605510650993-3d0d80c1032b?auto=format&fit=crop&q=80&w=800'], 'approved', 'Westlands, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'construction' LIMIT 1), 'Welding Machine', 'welding-machine-' || substring(md5(random()::text) from 1 for 6), 'Portable inverter welder.', 1500, ARRAY['https://images.unsplash.com/photo-1504917595217-d4dc5ebe6122?auto=format&fit=crop&q=80&w=800'], 'approved', 'Likoni, Mombasa'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'power-tools' LIMIT 1), 'Circular Saw', 'circular-saw-' || substring(md5(random()::text) from 1 for 6), 'Wood cutting saw.', 600, ARRAY['https://images.unsplash.com/photo-1572981779307-38b8cabb2407?auto=format&fit=crop&q=80&w=800'], 'approved', 'Gikomba, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'construction' LIMIT 1), 'Concrete Mixer', 'concrete-mixer-' || substring(md5(random()::text) from 1 for 6), 'Electric concrete mixer.', 3000, ARRAY['https://images.unsplash.com/photo-1589939705384-5185137a7f0f?auto=format&fit=crop&q=80&w=800'], 'approved', 'Kitengela, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'gardening' LIMIT 1), 'Lawn Mower', 'lawn-mower-' || substring(md5(random()::text) from 1 for 6), 'Petrol powered lawn mower.', 1000, ARRAY['https://images.unsplash.com/photo-1592424838380-60b78477f139?auto=format&fit=crop&q=80&w=800'], 'approved', 'Runda, Nairobi'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'power-tools' LIMIT 1), 'Tool Box Set', 'tool-box-' || substring(md5(random()::text) from 1 for 6), 'Complete mechanic tool set.', 400, ARRAY['https://images.unsplash.com/photo-1530124566582-a618bc2615dc?auto=format&fit=crop&q=80&w=800'], 'approved', 'Industrial, Nakuru'),
        (v_owner_id, '33333333-3333-3333-3333-333333333333', (SELECT id FROM public.subcategories WHERE slug = 'construction' LIMIT 1), 'Jackhammer', 'jackhammer-' || substring(md5(random()::text) from 1 for 6), 'Demolition hammer.', 2500, ARRAY['https://images.unsplash.com/photo-1518655061710-5ccf392c275a?auto=format&fit=crop&q=80&w=800'], 'approved', 'Upper Hill, Nairobi');

    END IF;
END $$;
