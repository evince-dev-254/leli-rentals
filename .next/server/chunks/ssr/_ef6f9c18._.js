module.exports=[3130,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},7379,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(35112);var d=a.i(11011),e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,e)=>{let f=(0,d.createSlot)(`Primitive.${e}`),g=c.forwardRef((a,c)=>{let{asChild:d,...g}=a;return(0,b.jsx)(d?f:e,{...g,ref:c})});return g.displayName=`Primitive.${e}`,{...a,[e]:g}},{}),f="horizontal",g=["horizontal","vertical"],h=c.forwardRef((a,c)=>{var d;let{decorative:h,orientation:i=f,...j}=a,k=(d=i,g.includes(d))?i:f;return(0,b.jsx)(e.div,{"data-orientation":k,...h?{role:"none"}:{"aria-orientation":"vertical"===k?k:void 0,role:"separator"},...j,ref:c})});h.displayName="Separator";var i=a.i(97895);function j({className:a,orientation:c="horizontal",decorative:d=!0,...e}){return(0,b.jsx)(h,{"data-slot":"separator",decorative:d,orientation:c,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...e})}a.s(["Separator",()=>j],7379)},88237,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,c.cn)("w-full caption-bottom text-sm",a),...d})})}function e({className:a,...d}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,c.cn)("[&_tr]:border-b",a),...d})}function f({className:a,...d}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,c.cn)("[&_tr:last-child]:border-0",a),...d})}function g({className:a,...d}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,c.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...d})}function h({className:a,...d}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,c.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...d})}function i({className:a,...d}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,c.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...d})}a.s(["Table",()=>d,"TableBody",()=>f,"TableCell",()=>i,"TableHead",()=>h,"TableHeader",()=>e,"TableRow",()=>g])},33441,a=>{"use strict";var b=a.i(34157);a.s(["Check",()=>b.default])},5151,a=>{"use strict";let b=(0,a.i(70106).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);a.s(["Copy",()=>b],5151)},1618,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(78560),e=a.i(42521),f=a.i(5050),g=(0,f.createServerReference)("60b8d69f5284599d2bb412537c97663788d5090af9",f.callServer,void 0,f.findSourceMapURL,"joinAffiliateProgram"),h=a.i(3130),i=a.i(60246),j=a.i(90166),k=a.i(5151),l=a.i(33441),m=a.i(96221),n=a.i(40695),o=a.i(7379),p=a.i(88237),q=a.i(7706),r=a.i(54161);function s(){let[a,f]=(0,c.useState)(null),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1);(0,c.useEffect)(()=>{(async()=>{let{data:{user:a}}=await d.supabase.auth.getUser();if(f(a),!a)return x(!1);try{let{data:b}=await d.supabase.from("user_profiles").select("role").eq("id",a.id).single(),[c,f]=await Promise.all([(0,e.getAffiliateData)(a.id),(0,e.getAffiliateReferrals)(a.id)]);if(t(c),v(f||[]),!c&&b?.role==="affiliate"){await new Promise(a=>setTimeout(a,500));let b=await (0,e.getAffiliateData)(a.id);b&&t(b)}}catch(a){console.error(a)}finally{x(!1)}})()},[]);let C=async()=>{if(a){z(!0);try{let b=await g(a.id,a.email||"");if(b.success){t(b.data);let c=await (0,e.getAffiliateReferrals)(a.id);v(c||[])}else alert("Failed to join: "+b.error)}catch(a){console.error(a),alert("An error occurred")}finally{z(!1)}}},D=a=>{navigator.clipboard.writeText(a),B(!0),setTimeout(()=>B(!1),2e3)};if(w)return(0,b.jsx)("div",{className:"flex items-center justify-center p-12",children:(0,b.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})});if(!a)return(0,b.jsx)("div",{className:"text-center p-8",children:"Please sign in to view the affiliate dashboard."});if(!s)return(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 text-center border rounded-lg bg-card/50 shadow-sm space-y-4 max-w-2xl mx-auto mt-8",children:[(0,b.jsx)("div",{className:"p-4 bg-primary/10 rounded-full mb-4",children:(0,b.jsx)(j.DollarSign,{className:"h-10 w-10 text-primary"})}),(0,b.jsx)("h3",{className:"text-2xl font-bold",children:"Become an Affiliate Partner"}),(0,b.jsx)("p",{className:"text-muted-foreground max-w-md",children:"Earn 10% commission for every user you refer to Leli Rentals. Join our affiliate program today and start earning passive income."}),(0,b.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg text-sm text-left w-full space-y-2",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Program Terms:"}),(0,b.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,b.jsx)("li",{children:"10% commission on all completed bookings from your referrals."}),(0,b.jsx)("li",{children:"Payouts are processed monthly via Bank Transfer or Mobile Money."}),(0,b.jsx)("li",{children:"Minimum payout threshold: KES 1,000."}),(0,b.jsx)("li",{children:"Spamming or misleading promotion is strictly prohibited."})]})]}),(0,b.jsx)(n.Button,{onClick:C,disabled:y,size:"lg",className:"mt-6",children:y?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Joining..."]}):"Agree & Join Program"})]});let E=`https://leli.rentals/signup?ref=${s.invite_code}`;return(0,b.jsxs)("div",{className:"space-y-8 animate-in fade-in duration-500",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Affiliate Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Track your referrals and earnings."})]}),(0,b.jsx)(h.Card,{className:"w-full md:w-auto bg-primary/5 border-primary/20",children:(0,b.jsxs)(h.CardContent,{className:"p-4 flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Your Referral Code"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xl font-mono font-bold",children:s.invite_code}),(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>D(s.invite_code),children:A?(0,b.jsx)(l.Check,{className:"h-3 w-3 text-green-500"}):(0,b.jsx)(k.Copy,{className:"h-3 w-3"})})]})]}),(0,b.jsx)(o.Separator,{orientation:"vertical",className:"h-10 mx-2"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Referral Link"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-foreground/80 truncate max-w-[150px]",children:E}),(0,b.jsx)(n.Button,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>D(E),children:A?(0,b.jsx)(l.Check,{className:"h-3 w-3 text-green-500"}):(0,b.jsx)(k.Copy,{className:"h-3 w-3"})})]})]})]})})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Total Referrals"}),(0,b.jsx)(i.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:s.total_referrals||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Users signed up"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Total Earnings"}),(0,b.jsx)(j.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["Kes ",s.total_earnings||0]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Lifetime earnings"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Pending Payout"}),(0,b.jsx)(j.DollarSign,{className:"h-4 w-4 text-orange-500"})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-orange-500",children:["Kes ",s.pending_earnings||0]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ready to withdraw"})]})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsxs)(h.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Commission Rate"}),(0,b.jsxs)(r.Badge,{variant:"outline",children:[s.commission_rate,"%"]})]}),(0,b.jsxs)(h.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:[s.commission_rate,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per successful booking"})]})]})]}),(0,b.jsx)("div",{className:"grid gap-4",children:(0,b.jsxs)(h.Card,{className:"col-span-1",children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)(h.CardTitle,{children:"Recent Referrals"})}),(0,b.jsx)(h.CardContent,{children:u.length>0?(0,b.jsxs)(p.Table,{children:[(0,b.jsx)(p.TableHeader,{children:(0,b.jsxs)(p.TableRow,{children:[(0,b.jsx)(p.TableHead,{children:"User"}),(0,b.jsx)(p.TableHead,{children:"Date"}),(0,b.jsx)(p.TableHead,{children:"Commission"}),(0,b.jsx)(p.TableHead,{className:"text-right",children:"Status"})]})}),(0,b.jsx)(p.TableBody,{children:u.map(a=>(0,b.jsxs)(p.TableRow,{children:[(0,b.jsx)(p.TableCell,{className:"font-medium",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(q.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(q.AvatarImage,{src:a.referred_user?.avatar_url}),(0,b.jsx)(q.AvatarFallback,{children:a.referred_user?.full_name?.[0]||"U"})]}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{children:a.referred_user?.full_name||"Anonymous User"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.referred_user?.email})]})]})}),(0,b.jsx)(p.TableCell,{children:new Date(a.created_at).toLocaleDateString()}),(0,b.jsxs)(p.TableCell,{className:"font-medium",children:["Kes ",a.commission_amount]}),(0,b.jsx)(p.TableCell,{className:"text-right",children:(0,b.jsx)(r.Badge,{variant:"paid"===a.commission_status?"default":"secondary",children:a.commission_status})})]},a.id))})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center border rounded-lg border-dashed",children:[(0,b.jsx)(i.Users,{className:"h-8 w-8 text-muted-foreground mb-4"}),(0,b.jsx)("h4",{className:"text-lg font-medium text-muted-foreground",children:"No referrals yet"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm mt-2",children:"Share your referral code to start earning commissions!"})]})})]})})]})}a.s(["default",()=>s],1618)}];

//# sourceMappingURL=_ef6f9c18._.js.map