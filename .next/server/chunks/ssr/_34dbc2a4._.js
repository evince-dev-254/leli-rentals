module.exports=[32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},50381,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33441);let e=(0,a.i(70106).default)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);var f=a.i(1027),g=a.i(92e3),h=a.i(11156),i=a.i(96221),j=a.i(78560),k=a.i(3130),l=a.i(40695),m=a.i(54161),n=a.i(2150),o=a.i(21958),p=a.i(65733);let q=(0,a.i(19721).default)(async()=>{},{loadableGenerated:{modules:[64961]},ssr:!1}),r=({amount:a,email:c,metadata:d,onSuccess:e,onClose:f,text:g="Pay Now",className:h})=>(0,b.jsx)("div",{className:h,children:(0,b.jsx)(q,{email:c,amount:100*a,metadata:d||{},publicKey:"pk_live_a529817288437ffe8460ecc16f2d34930b5cb0ec",text:g,onSuccess:a=>{e&&e(a)},onClose:()=>{f&&f()},className:"w-full h-12 bg-primary text-primary-foreground hover:bg-primary/90 rounded-md font-medium flex items-center justify-center transition-colors"})});var s=a.i(23292);let t=[{id:"weekly",name:"Weekly Plan",price:500,duration:"7 days",listingLimit:10,features:["Up to 10 listings","Basic analytics","Email support","Standard visibility"],popular:!1},{id:"monthly",name:"Monthly Plan",price:1e3,duration:"30 days",listingLimit:-1,features:["Unlimited listings","Advanced analytics","Priority support","Featured listings","Promotional tools","Early access to features"],popular:!0}];function u(){let[a,q]=(0,c.useState)(null),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(0),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null);(0,c.useEffect)(()=>{!async function(){let{data:{user:a}}=await j.supabase.auth.getUser();if(!a)return x(!1);D(a);let{count:b}=await j.supabase.from("listings").select("*",{count:"exact",head:!0}).eq("owner_id",a.id);z(b||0);let{data:c}=await j.supabase.from("subscriptions").select("*").eq("user_id",a.id).in("status",["active","trialing"]).order("end_date",{ascending:!1}).limit(1).single();B(c),x(!1)}()},[]);let E={name:A?.plan_type==="monthly"?"Monthly Plan":"Weekly Plan",expiresAt:new Date(A?.end_date?A.end_date:Date.now()+3456e5),listingsUsed:y,listingsLimit:A?.plan_type==="monthly"?-1:10},F=async b=>{x(!0);try{let c=t.find(b=>b.id===a),d=await fetch("/api/paystack/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reference:b.reference,planId:a,userId:C?.id,email:C?.email,amount:c?.price})}),e=await d.json();if(!d.ok)throw Error(e.error||"Payment verification failed");s.toast.success("Subscription activated successfully!"),v(!1),window.location.reload()}catch(a){console.error("Payment error:",a),s.toast.error(a.message||"Failed to process payment"),x(!1)}};if(w)return(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-primary"})});let G=Math.ceil((E.expiresAt.getTime()-Date.now())/864e5),H=-1===E.listingsLimit?0:E.listingsUsed/E.listingsLimit*100;return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Subscription"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your subscription plan and billing"})]}),(0,b.jsxs)(k.Card,{className:"glass-card",children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(k.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-5 w-5 text-primary"}),"Current Plan"]}),(0,b.jsx)(k.CardDescription,{children:"Your active subscription details"})]}),(0,b.jsx)(m.Badge,{className:"bg-primary",children:E.name})]})}),(0,b.jsxs)(k.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-background/50",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Expires In"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[G," days"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:E.expiresAt.toLocaleDateString()})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-background/50",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Listings Used"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[E.listingsUsed," / ",-1===E.listingsLimit?"âˆž":E.listingsLimit]}),-1!==E.listingsLimit&&(0,b.jsx)(n.Progress,{value:H,className:"h-2 mt-2"})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-background/50",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Plan Price"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:["KSh ",A?.plan_type==="monthly"?"1000":"500"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["per ",A?.plan_type==="monthly"?"month":"week"]})]})]}),-1!==E.listingsLimit&&E.listingsUsed>=.8*E.listingsLimit&&(0,b.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-orange-500/10 border border-orange-500/30",children:[(0,b.jsx)(g.AlertCircle,{className:"h-5 w-5 text-orange-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-orange-600",children:"Running low on listing slots"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Upgrade to Monthly for unlimited listings"})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Choose Your Plan"}),(0,b.jsx)("div",{className:"grid gap-6 md:grid-cols-2",children:t.map(a=>(0,b.jsxs)(k.Card,{className:`glass-card relative ${a.popular?"border-primary ring-2 ring-primary/20":""}`,children:[a.popular&&(0,b.jsx)(m.Badge,{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-primary",children:"Most Popular"}),(0,b.jsxs)(k.CardHeader,{children:[(0,b.jsxs)(k.CardTitle,{className:"flex items-center gap-2",children:[a.popular?(0,b.jsx)(f.Zap,{className:"h-5 w-5 text-primary"}):(0,b.jsx)(e,{className:"h-5 w-5"}),a.name]}),(0,b.jsxs)(k.CardDescription,{children:[a.duration," duration"]})]}),(0,b.jsxs)(k.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{className:"text-4xl font-bold",children:["KSh ",a.price.toLocaleString()]}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:["/","7 days"===a.duration?"week":"month"]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-primary/10",children:[(0,b.jsx)(d.Check,{className:"h-4 w-4 text-primary"}),(0,b.jsxs)("span",{className:"font-medium",children:[-1===a.listingLimit?"Unlimited":`Up to ${a.listingLimit}`," listings"]})]}),a.features.slice(1).map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Check,{className:"h-4 w-4 text-green-500"}),(0,b.jsx)("span",{className:"text-sm",children:a})]},a))]}),(0,b.jsx)(l.Button,{className:`w-full ${a.popular?"bg-primary text-primary-foreground":""}`,variant:a.popular?"default":"outline",onClick:()=>{q(a.id),v(!0)},children:E.name===a.name?"Renew Plan":"Subscribe"})]})]},a.id))})]}),(0,b.jsxs)(k.Card,{className:"glass-card",children:[(0,b.jsxs)(k.CardHeader,{children:[(0,b.jsx)(k.CardTitle,{children:"Billing History"}),(0,b.jsx)(k.CardDescription,{children:"Your past transactions"})]}),(0,b.jsx)(k.CardContent,{children:(0,b.jsxs)(o.Tabs,{defaultValue:"all",children:[(0,b.jsxs)(o.TabsList,{children:[(0,b.jsx)(o.TabsTrigger,{value:"all",children:"All"}),(0,b.jsx)(o.TabsTrigger,{value:"subscriptions",children:"Subscriptions"}),(0,b.jsx)(o.TabsTrigger,{value:"payouts",children:"Payouts"})]}),(0,b.jsx)(o.TabsContent,{value:"all",className:"mt-4",children:(0,b.jsx)("div",{className:"space-y-3",children:[{type:"subscription",desc:"Weekly Plan",date:"Dec 1, 2025",amount:-500},{type:"payout",desc:"Earnings Payout",date:"Nov 30, 2025",amount:45e3},{type:"subscription",desc:"Weekly Plan",date:"Nov 24, 2025",amount:-500},{type:"payout",desc:"Earnings Payout",date:"Nov 15, 2025",amount:32e3}].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-background/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`p-2 rounded-full ${"subscription"===a.type?"bg-primary/10 text-primary":"bg-green-500/10 text-green-500"}`,children:"subscription"===a.type?(0,b.jsx)(h.CreditCard,{className:"h-4 w-4"}):(0,b.jsx)(f.Zap,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.desc}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.date})]})]}),(0,b.jsxs)("span",{className:`font-semibold ${a.amount>0?"text-green-500":"text-foreground"}`,children:[a.amount>0?"+":"","KSh ",Math.abs(a.amount).toLocaleString()]})]},c))})}),(0,b.jsx)(o.TabsContent,{value:"subscriptions",className:"mt-4",children:(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"Subscription history will appear here"})}),(0,b.jsx)(o.TabsContent,{value:"payouts",className:"mt-4",children:(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"Payout history will appear here"})})]})})]}),(0,b.jsx)(p.Dialog,{open:u,onOpenChange:v,children:(0,b.jsxs)(p.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsx)(p.DialogTitle,{children:"Complete Payment"}),(0,b.jsx)(p.DialogDescription,{children:"Pay with Paystack to activate your subscription"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-secondary/50",children:[(0,b.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,b.jsx)("span",{children:"Plan"}),(0,b.jsx)("span",{className:"font-medium",children:t.find(b=>b.id===a)?.name})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Amount"}),(0,b.jsxs)("span",{className:"font-bold text-primary",children:["KSh ",t.find(b=>b.id===a)?.price.toLocaleString()]})]})]}),a&&(0,b.jsx)(r,{amount:t.find(b=>b.id===a)?.price||0,email:C?.email||"",metadata:{planId:a,userId:C?.id},onSuccess:F,onClose:()=>v(!1),text:`Pay KSh ${t.find(b=>b.id===a)?.price.toLocaleString()}`}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Secure payment powered by Paystack"})]})]})})]})}a.s(["SubscriptionPage",()=>u],50381)}];

//# sourceMappingURL=_34dbc2a4._.js.map