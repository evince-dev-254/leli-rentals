{"version":3,"sources":["../../../../components/ui/loading-logo.tsx","../../../../app/dashboard/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport Image from \"next/image\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\ninterface LoadingLogoProps {\r\n    className?: string\r\n    size?: number\r\n}\r\n\r\nexport function LoadingLogo({ className, size = 60 }: LoadingLogoProps) {\r\n    return (\r\n        <div className={cn(\"relative flex items-center justify-center\", className)}>\r\n            {/* Pulse Rings */}\r\n            <div className=\"absolute inset-0 bg-primary/20 rounded-full animate-ping opacity-75\" />\r\n            <div className=\"absolute inset-0 bg-primary/10 rounded-full animate-pulse delay-75\" />\r\n\r\n            {/* Logo Container */}\r\n            <div className=\"relative bg-background/80 backdrop-blur-sm rounded-full p-4 shadow-xl ring-1 ring-border/50 border border-primary/10\">\r\n                <Image\r\n                    src=\"/logo.png\"\r\n                    alt=\"Loading...\"\r\n                    width={size}\r\n                    height={size}\r\n                    className=\"h-auto w-auto object-contain dark:invert animate-pulse duration-1000\"\r\n                    priority\r\n                />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport AdminDashboard from \"@/components/dashboard/admin-dashboard\"\r\nimport { LoadingLogo } from \"@/components/ui/loading-logo\"\r\nimport { Loader2 } from \"lucide-react\"\r\n\r\nexport default function DashboardPage() {\r\n  const [user, setUser] = useState<any>(null)\r\n  const [profile, setProfile] = useState<any>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const router = useRouter()\r\n\r\n  useEffect(() => {\r\n    const getUser = async () => {\r\n      try {\r\n        const { data: { user }, error: userError } = await supabase.auth.getUser()\r\n\r\n        if (userError || !user) {\r\n          router.push('/sign-in')\r\n          return\r\n        }\r\n\r\n        setUser(user)\r\n\r\n        // Fetch user profile from user_profiles table\r\n        const { data: profileData, error: profileError } = await supabase\r\n          .from(\"user_profiles\")\r\n          .select(\"*\")\r\n          .eq(\"id\", user.id)\r\n          .single()\r\n\r\n        if (profileError) {\r\n          if (profileError.code !== 'PGRST116') {\r\n            console.error('Profile fetch error:', profileError)\r\n          }\r\n          router.push('/select-role')\r\n          return\r\n        }\r\n\r\n        setProfile(profileData)\r\n\r\n        setProfile(profileData)\r\n\r\n        // Redirect logic\r\n        // If user is conceptually an admin (either role=='admin' OR is_admin==true), send to Admin Dashboard.\r\n        // NOTE: If an owner is also an admin, usually they want the Admin dashboard more prominent or a choice.\r\n        // For now, we prioritize Admin access if they visit the generic /dashboard.\r\n        if (profileData.role === 'admin' || profileData.is_admin) {\r\n          router.push('/admin')\r\n        }\r\n        // Otherwise, send to specific role dashboard\r\n        else if (profileData.role === 'renter') {\r\n          router.push('/dashboard/renter')\r\n        } else if (profileData.role === 'owner') {\r\n          router.push('/dashboard/owner')\r\n        } else if (profileData.role === 'affiliate') {\r\n          router.push('/dashboard/affiliate')\r\n        }\r\n\r\n      } catch (error) {\r\n        console.error('Dashboard error:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    getUser()\r\n  }, [router])\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"flex flex-col items-center\">\r\n          <LoadingLogo size={80} />\r\n          <p className=\"mt-6 text-muted-foreground animate-pulse font-medium\">Loading dashboard...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // If redirecting, we might show a flash. Return null or loader.\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center\">\r\n      <LoadingLogo size={60} />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAOO,SAAS,EAAY,WAAE,CAAS,MAAE,EAAO,EAAE,CAAoB,EAClE,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAA,EAAA,EAAA,EAAA,AAAE,EAAC,4CAA6C,aAE5D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wEACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uEAGf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gIACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAK,CAAA,CACF,IAAI,YACJ,IAAI,aACJ,MAAO,EACP,OAAQ,EACR,UAAU,uEACV,QAAQ,CAAA,CAAA,QAK5B,qEC5BA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OAGe,SAAS,IACtB,GAAM,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MAChC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MACtC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,UA2DxB,CAzDA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAsDR,CArDgB,UACd,GAAI,CACF,GAAM,CAAE,KAAM,MAAE,CAAI,CAAE,CAAE,MAAO,CAAS,CAAE,CAAG,MAAM,EAAA,QAAQ,CAAC,IAAI,CAAC,OAAO,GAExE,GAAI,GAAa,CAAC,EAAM,YACtB,EAAO,IAAI,CAAC,YAId,EAAQ,GAGR,GAAM,CAAE,KAAM,CAAW,CAAE,MAAO,CAAY,CAAE,CAAG,MAAM,EAAA,QAAQ,CAC9D,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,KAAM,EAAK,EAAE,EAChB,MAAM,GAET,GAAI,EAAc,CACU,YAAY,CAAlC,EAAa,IAAI,EACnB,QAAQ,KAAK,CAAC,uBAAwB,GAExC,EAAO,IAAI,CAAC,gBACZ,MACF,CAEA,EAAW,GAEX,EAAW,GAMc,UAArB,EAAY,IAAI,EAAgB,EAAY,QAAQ,CACtD,CADwD,CACjD,IAAI,CAAC,UAGgB,UAAU,CAA/B,EAAY,IAAI,CACvB,EAAO,IAAI,CAAC,qBACkB,SAAS,CAA9B,EAAY,IAAI,CACzB,EAAO,IAAI,CAAC,oBACkB,aAAa,CAAlC,EAAY,IAAI,EACzB,EAAO,IAAI,CAAC,uBAGhB,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,mBAAoB,EACpC,QAAU,CACR,GAAW,EACb,EACF,GAGF,EAAG,CAAC,EAAO,EAEP,GAEA,CAAA,EAAA,EAAA,CAFS,EAET,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,KAAM,KACnB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,gEAAuD,8BAQ1E,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,KAAM,MAGzB"}