module.exports=[42132,a=>{"use strict";var b=a.i(87924),c=a.i(60246);let d=(0,a.i(70106).default)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var e=a.i(17371),f=a.i(66384),g=a.i(24669),h=a.i(73570),i=a.i(41710),j=a.i(3130),k=a.i(54161),l=a.i(40695),m=a.i(7706),n=a.i(72131),o=a.i(78560),p=a.i(38246),q=a.i(42724),r=a.i(44513),s=a.i(52587),t=a.i(23464),u=a.i(57270),v=a.i(7308),w=a.i(59296),x=a.i(38124),y=a.i(74016),z=a.i(22658),A=a.i(89512);function B(){let[a,B]=(0,n.useState)(!0),[C,D]=(0,n.useState)({totalUsers:0,totalOwners:0,totalAffiliates:0,pendingVerifications:0,activeListings:0,totalBookings:0,totalRevenue:0,suspendedAccounts:0}),[E,F]=(0,n.useState)([]),[G,H]=(0,n.useState)([]),[I,J]=(0,n.useState)([]);return((0,n.useEffect)(()=>{let a=!0;return async function(){try{let[{data:b,error:c,count:d},{data:e,error:f,count:g}]=await Promise.all([o.supabase.from("user_profiles").select("id",{count:"exact",head:!0}),o.supabase.from("user_profiles").select("id",{count:"exact",head:!0}).eq("role","owner")]),[{data:h,error:i,count:j},{data:k,error:l,count:m}]=await Promise.all([o.supabase.from("user_profiles").select("id",{count:"exact",head:!0}).eq("role","affiliate"),o.supabase.from("listings").select("id",{count:"exact",head:!0}).eq("status","approved")]),[{data:n,error:p,count:q},{data:r,error:s}]=await Promise.all([o.supabase.from("bookings").select("id",{count:"exact",head:!0}),o.supabase.from("bookings").select("total_amount")]),t=(s?[]:(await o.supabase.from("bookings").select("total_amount")).data||[]).reduce((a,b)=>a+Number(b.total_amount||0),0),{data:u,error:v}=await o.supabase.from("user_profiles").select("*").eq("account_status","suspended").limit(5),{data:w,error:x}=await o.supabase.from("user_profiles").select("*").or("account_status.eq.pending_verification,role.eq.owner,role.eq.affiliate").limit(5),{data:y}=await o.supabase.from("user_profiles").select("id, full_name, role, created_at").order("created_at",{ascending:!1}).limit(5),{data:z}=await o.supabase.from("listings").select("id, title, owner_id, created_at").order("created_at",{ascending:!1}).limit(5),{data:A}=await o.supabase.from("bookings").select("id, listing_id, renter_id, created_at, total_amount").order("created_at",{ascending:!1}).limit(5),B=[...(y||[]).map(a=>({type:"user",action:`New ${a.role} registration`,user:a.full_name||"Unknown User",time:a.created_at,details:a.role})),...(z||[]).map(a=>({type:"listing",action:"New listing created",user:a.title,time:a.created_at,details:a.title})),...(A||[]).map(a=>({type:"booking",action:"New booking",user:`Booking #${a.id.slice(0,8)}`,time:a.created_at,details:`KSh ${a.total_amount}`}))].sort((a,b)=>new Date(b.time).getTime()-new Date(a.time).getTime()).slice(0,10);if(!a)return;D({totalUsers:Number(d)||0,totalOwners:Number(g)||0,totalAffiliates:Number(j)||0,pendingVerifications:w&&w.length||0,activeListings:Number(m)||0,totalBookings:Number(q)||0,totalRevenue:t,suspendedAccounts:u&&u.length||0}),F(w||[]),H(u||[]),J(B)}catch(a){console.error(a)}finally{a&&B(!1)}}(),()=>{a=!1}},[]),a)?(0,b.jsx)("div",{className:"flex h-96 items-center justify-center",children:(0,b.jsx)(A.LoadingLogo,{size:60})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Welcome back, Admin. Here is what is happening today."})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Users"}),(0,b.jsx)(c.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:C.totalUsers}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,b.jsx)(g.TrendingUp,{className:"h-3 w-3 text-green-500"}),(0,b.jsx)("span",{className:"text-xs text-green-500",children:"+12% from last month"})]})]})]}),(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Active Owners"}),(0,b.jsx)(d,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:C.totalOwners}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,b.jsx)(g.TrendingUp,{className:"h-3 w-3 text-green-500"}),(0,b.jsx)("span",{className:"text-xs text-green-500",children:"+8% from last month"})]})]})]}),(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Affiliates"}),(0,b.jsx)(e.UserPlus,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:C.totalAffiliates}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,b.jsx)(g.TrendingUp,{className:"h-3 w-3 text-green-500"}),(0,b.jsx)("span",{className:"text-xs text-green-500",children:"+15% from last month"})]})]})]}),(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Pending Verifications"}),(0,b.jsx)(f.ShieldAlert,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:C.pendingVerifications}),(0,b.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,b.jsx)(g.TrendingUp,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:"Recent changes"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(f.ShieldAlert,{className:"h-5 w-5 text-orange-500"}),"Pending Verifications"]}),(0,b.jsx)(j.CardDescription,{children:"Users awaiting document verification"})]}),(0,b.jsx)(l.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsx)(p.default,{href:"/admin/verifications",children:"View All"})})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:E.slice(0,4).map(a=>{let c=a.verificationDeadline?Math.ceil((a.verificationDeadline.getTime()-Date.now())/864e5):0,d=c<=2;return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-background/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(m.Avatar,{children:[(0,b.jsx)(m.AvatarImage,{src:a.avatarUrl||void 0}),(0,b.jsx)(m.AvatarFallback,{children:(a.fullName||"User").split(" ").map(a=>a[0]).join("")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.fullName}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Badge,{variant:"outline",className:"text-xs",children:a.role}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.email})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Badge,{variant:"submitted"===a.verificationStatus?"default":"pending"===a.verificationStatus?"secondary":"destructive",children:a.verificationStatus}),c>0&&(0,b.jsxs)(k.Badge,{variant:d?"destructive":"outline",className:"flex items-center gap-1",children:[(0,b.jsx)(i.Clock,{className:"h-3 w-3"}),c,"d left"]})]})]},a.id)})})})]}),(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(h.AlertTriangle,{className:"h-5 w-5 text-red-500"}),"Suspended Accounts"]}),(0,b.jsx)(j.CardDescription,{children:"Accounts suspended due to verification issues"})]}),(0,b.jsx)(l.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,b.jsx)(p.default,{href:"/admin/users?status=suspended",children:"View All"})})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:0===G.length?(0,b.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No suspended accounts"}):G.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-background/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(m.Avatar,{children:[(0,b.jsx)(m.AvatarImage,{src:a.avatarUrl||void 0}),(0,b.jsx)(m.AvatarFallback,{children:(a.fullName||"User").split(" ").map(a=>a[0]).join("")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.fullName}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Badge,{variant:"outline",className:"text-xs",children:a.role}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:a.email})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Badge,{variant:"destructive",children:"Suspended"}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",children:"Review"})]})]},a.id))})})]})]}),(0,b.jsxs)(j.Card,{className:"glass-card",children:[(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsx)(j.CardTitle,{children:"Recent Activity"}),(0,b.jsx)(j.CardDescription,{children:"Latest actions across the platform"})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[I.map((a,c)=>{var d,e;return(0,b.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`h-2 w-2 rounded-full ${"suspension"===a.type?"bg-red-500":"verification"===a.type?"bg-orange-500":"booking"===a.type?"bg-green-500":"bg-blue-500"}`}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.action}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.user})]})]}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:(d=new Date(a.time),e={addSuffix:!0},function(a,b,c){var d;let e,f=(0,s.getDefaultOptions)(),g=c?.locale??f.locale??r.defaultLocale,h=(0,v.compareAsc)(a,b);if(isNaN(h))throw RangeError("Invalid time value");let i=Object.assign({},c,{addSuffix:c?.addSuffix,comparison:h}),[j,k]=(0,u.normalizeDates)(c?.in,...h>0?[b,a]:[a,b]),l=(d=void 0,a=>{let b=(d?Math[d]:Math.trunc)(a);return 0===b?0:b})(((0,y.toDate)(k)-(0,y.toDate)(j))/1e3),m=Math.round((l-((0,t.getTimezoneOffsetInMilliseconds)(k)-(0,t.getTimezoneOffsetInMilliseconds)(j))/1e3)/60);if(m<2)if(c?.includeSeconds)if(l<5)return g.formatDistance("lessThanXSeconds",5,i);else if(l<10)return g.formatDistance("lessThanXSeconds",10,i);else if(l<20)return g.formatDistance("lessThanXSeconds",20,i);else if(l<40)return g.formatDistance("halfAMinute",0,i);else if(l<60)return g.formatDistance("lessThanXMinutes",1,i);else return g.formatDistance("xMinutes",1,i);else if(0===m)return g.formatDistance("lessThanXMinutes",1,i);else return g.formatDistance("xMinutes",m,i);if(m<45)return g.formatDistance("xMinutes",m,i);if(m<90)return g.formatDistance("aboutXHours",1,i);if(m<w.minutesInDay){let a=Math.round(m/60);return g.formatDistance("aboutXHours",a,i)}if(m<2520)return g.formatDistance("xDays",1,i);else if(m<w.minutesInMonth){let a=Math.round(m/w.minutesInDay);return g.formatDistance("xDays",a,i)}else if(m<2*w.minutesInMonth)return e=Math.round(m/w.minutesInMonth),g.formatDistance("aboutXMonths",e,i);if((e=function(a,b,c){var d;let e,f,[g,h,i]=(0,u.normalizeDates)(void 0,a,a,b),j=(0,v.compareAsc)(h,i),k=Math.abs((0,x.differenceInCalendarMonths)(h,i));if(k<1)return 0;1===h.getMonth()&&h.getDate()>27&&h.setDate(30),h.setMonth(h.getMonth()-j*k);let l=(0,v.compareAsc)(h,i)===-j;+(e=(0,y.toDate)(g,void 0),d=void 0,(f=(0,y.toDate)(e,d?.in)).setHours(23,59,59,999),f)==+(0,z.endOfMonth)(e,void 0)&&1===k&&1===(0,v.compareAsc)(g,i)&&(l=!1);let m=j*(k-l);return 0===m?0:m}(k,j))<12){let a=Math.round(m/w.minutesInMonth);return g.formatDistance("xMonths",a,i)}{let a=e%12,b=Math.trunc(e/12);return a<3?g.formatDistance("aboutXYears",b,i):a<9?g.formatDistance("overXYears",b,i):g.formatDistance("almostXYears",b+1,i)}}(d,(0,q.constructFrom)(d,Date.now()),e))})]},c)}),0===I.length&&(0,b.jsx)("p",{className:"text-center text-muted-foreground",children:"No recent activity"})]})})]})]})}a.s(["AdminDashboard",()=>B],42132)}];

//# sourceMappingURL=components_admin_admin-dashboard_tsx_498f3e9c._.js.map