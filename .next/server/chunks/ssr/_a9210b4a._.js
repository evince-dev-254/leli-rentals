module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},27837,a=>{"use strict";var b=a.i(51100);let c=process.env.SUPABASE_SERVICE_ROLE_KEY,d=(0,b.createClient)("https://tdtjevpnqrwqcjnuywrn.supabase.co",c,{auth:{autoRefreshToken:!1,persistSession:!1}});a.s(["supabaseAdmin",0,d])},42324,a=>{"use strict";var b=a.i(96077),c=a.i(37936),d=a.i(27837),e=a.i(17538),f=a.i(7997),g=a.i(3263),h=a.i(63112),i=a.i(416),j=a.i(6796),k=a.i(33132),l=a.i(57149),m=a.i(66630),n=a.i(28277),o=a.i(87304),p=a.i(80184),q=a.i(13095);async function r(a){let b=Math.floor(1e5+9e5*Math.random()).toString(),{data:{users:c},error:q}=await d.supabaseAdmin.auth.admin.listUsers();if(q)return{success:!1,error:q.message};let r=c.find(b=>b.email===a);if(!r)return{success:!1,error:"User not found"};let{error:s}=await d.supabaseAdmin.auth.admin.updateUserById(r.id,{user_metadata:{...r.user_metadata,custom_otp:b,custom_otp_sent_at:new Date().toISOString()}});if(s)return{success:!1,error:s.message};try{console.log(`[DEV ONLY] Generated OTP for ${a}: ${b}`);let c=await e.resend.emails.send({from:"Leli Rentals <onboarding@leli.rentals>",to:a,subject:"Your Verification Code",react:(({code:a})=>(0,f.jsxs)(k.Html,{children:[(0,f.jsx)(i.Head,{}),(0,f.jsxs)(m.Preview,{children:["Your Verification Code: ",a]}),(0,f.jsx)(p.Tailwind,{config:{theme:{extend:{colors:{brand:"#ea580c"}}}},children:(0,f.jsx)(g.Body,{className:"bg-white my-auto mx-auto font-sans",children:(0,f.jsxs)(h.Container,{className:"border border-solid border-[#eaeaea] rounded my-[40px] mx-auto p-[20px] w-[465px]",children:[(0,f.jsx)(n.Section,{className:"mt-[32px]",children:(0,f.jsx)(l.Img,{src:"http://localhost:3000/logo.png",width:"120",height:"32",alt:"Leli Rentals",className:"my-0 mx-auto"})}),(0,f.jsx)(j.Heading,{className:"text-black text-[24px] font-normal text-center p-0 my-[30px] mx-0",children:"Verify Your Account"}),(0,f.jsx)(o.Text,{className:"text-black text-[14px] leading-[24px]",children:"Here is your verification code to complete your signup:"}),(0,f.jsx)(n.Section,{className:"bg-slate-100 p-[20px] rounded text-center my-[20px]",children:(0,f.jsx)(o.Text,{className:"text-black text-[32px] font-bold tracking-[6px] m-0",children:a})}),(0,f.jsx)(o.Text,{className:"text-black text-[14px] leading-[24px] text-center",children:"This code will expire in 10 minutes."})]})})})]}))({code:b})});if(c.error){if(console.error("Resend API Error:",c.error),c.error.message?.includes("only send testing emails to your own email address"))return console.warn("⚠️ RESEND SANDBOX LIMITATION: You can only send to your verified email. The OTP has been logged above for your convenience."),{success:!0};return{success:!1,error:c.error.message}}return{success:!0}}catch(a){return console.error("Email sending failed:",a),{success:!1,error:a.message}}}async function s(a,b,c,e){let{data:{users:f},error:g}=await d.supabaseAdmin.auth.admin.listUsers();if(g)return{success:!1,error:g.message};let h=f.find(b=>b.email===a);if(!h)return{success:!1,error:"User not found"};if(h.user_metadata?.custom_otp!==b)return{success:!1,error:"Invalid code"};{let a={email_confirm:!0,user_metadata:{...h.user_metadata,custom_otp:null}};c&&(a.password=c),e&&(a.user_metadata.full_name=e);let{error:b}=await d.supabaseAdmin.auth.admin.updateUserById(h.id,a);return b?{success:!1,error:b.message}:{success:!0}}}async function t({email:a,password:b,data:c}){try{let{data:e,error:f}=await d.supabaseAdmin.auth.admin.createUser({email:a,password:b,email_confirm:!1,user_metadata:c});if(f)return console.error("Admin create user error:",f),{success:!1,error:f.message};return{success:!0,user:e.user}}catch(a){return console.error("Registration error:",a),{success:!1,error:a.message||"Registration failed"}}}(0,q.ensureServerEntryExports)([r,s]),(0,c.registerServerReference)(r,"4075bbdb2ca7d6dbe0c38be9664ddb06adfa49638c",null),(0,c.registerServerReference)(s,"78c519256122260b30e4eaeb7222d35a71686cc0a3",null),(0,q.ensureServerEntryExports)([t]),(0,c.registerServerReference)(t,"402ae546aed102d64769f54943c332ada2d9deff94",null),a.s([],46100),a.i(46100),a.s(["402ae546aed102d64769f54943c332ada2d9deff94",()=>t,"4075bbdb2ca7d6dbe0c38be9664ddb06adfa49638c",()=>r,"60eb1c4f17aa689bd417ddf6139ff5290a11f54209",()=>b.sendWelcomeEmail,"78c519256122260b30e4eaeb7222d35a71686cc0a3",()=>s],42324)},44085,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_next_dist_compiled_react-dom_server_node_ec48417a.js","server/chunks/ssr/[root-of-the-server]__57df1cf7._.js"].map(b=>a.l(b))).then(()=>b(30227)))}];

//# sourceMappingURL=_a9210b4a._.js.map