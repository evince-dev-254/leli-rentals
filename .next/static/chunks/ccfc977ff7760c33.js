(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var a=e.i(43476),s=e.i(47163);function t({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function r({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function l({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...t})}function i({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...t})}function n({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...t})}e.s(["Card",()=>t,"CardContent",()=>n,"CardDescription",()=>i,"CardHeader",()=>r,"CardTitle",()=>l])},31278,e=>{"use strict";let a=(0,e.i(75254).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},69035,e=>{"use strict";var a=e.i(43476),s=e.i(71645);e.i(74080);var t=e.i(91918),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let l=(0,t.createSlot)(`Primitive.${r}`),i=s.forwardRef((e,s)=>{let{asChild:t,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(t?l:r,{...i,ref:s})});return i.displayName=`Primitive.${r}`,{...e,[r]:i}},{}),l="horizontal",i=["horizontal","vertical"],n=s.forwardRef((e,s)=>{var t;let{decorative:n,orientation:d=l,...o}=e,c=(t=d,i.includes(t))?d:l;return(0,a.jsx)(r.div,{"data-orientation":c,...n?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...o,ref:s})});n.displayName="Separator";var d=e.i(47163);function o({className:e,orientation:s="horizontal",decorative:t=!0,...r}){return(0,a.jsx)(n,{"data-slot":"separator",decorative:t,orientation:s,className:(0,d.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}e.s(["Separator",()=>o],69035)},47627,e=>{"use strict";var a=e.i(43476),s=e.i(47163);function t({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...t})})}function r({className:e,...t}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...t})}function l({className:e,...t}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...t})}function i({className:e,...t}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function n({className:e,...t}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function d({className:e,...t}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}e.s(["Table",()=>t,"TableBody",()=>l,"TableCell",()=>d,"TableHead",()=>n,"TableHeader",()=>r,"TableRow",()=>i])},43531,e=>{"use strict";var a=e.i(78745);e.s(["Check",()=>a.default])},74886,e=>{"use strict";let a=(0,e.i(75254).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>a],74886)},73380,e=>{"use strict";e.i(47167);var a=e.i(43476),s=e.i(71645),t=e.i(17927),r=e.i(27158),l=e.i(95187),i=(0,l.createServerReference)("601796f08834749640eff9c7237738fe2946987897",l.callServer,void 0,l.findSourceMapURL,"joinAffiliateProgram"),n=e.i(70065),d=e.i(61911),o=e.i(12426),c=e.i(74886),m=e.i(43531),x=e.i(31278),u=e.i(67881),f=e.i(69035),h=e.i(47627),j=e.i(63270),p=e.i(94179);function g(){let[e,l]=(0,s.useState)(null),[g,b]=(0,s.useState)(null),[N,v]=(0,s.useState)([]),[w,y]=(0,s.useState)(!0),[C,T]=(0,s.useState)(!1),[_,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await t.supabase.auth.getUser();if(l(e),!e)return y(!1);try{let{data:a}=await t.supabase.from("user_profiles").select("role").eq("id",e.id).single(),[s,l]=await Promise.all([(0,r.getAffiliateData)(e.id),(0,r.getAffiliateReferrals)(e.id)]);if(b(s),v(l||[]),!s&&a?.role==="affiliate"){await new Promise(e=>setTimeout(e,500));let a=await (0,r.getAffiliateData)(e.id);a&&b(a)}}catch(e){console.error(e)}finally{y(!1)}})()},[]);let S=async()=>{if(e){T(!0);try{let a=await i(e.id,e.email||"");if(a.success){b(a.data);let s=await (0,r.getAffiliateReferrals)(e.id);v(s||[])}else alert("Failed to join: "+a.error)}catch(e){console.error(e),alert("An error occurred")}finally{T(!1)}}},R=e=>{navigator.clipboard.writeText(e),k(!0),setTimeout(()=>k(!1),2e3)};if(w)return(0,a.jsx)("div",{className:"flex items-center justify-center p-12",children:(0,a.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})});if(!e)return(0,a.jsx)("div",{className:"text-center p-8",children:"Please sign in to view the affiliate dashboard."});if(!g)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 text-center border rounded-lg bg-card/50 shadow-sm space-y-4 max-w-2xl mx-auto mt-8",children:[(0,a.jsx)("div",{className:"p-4 bg-primary/10 rounded-full mb-4",children:(0,a.jsx)(o.DollarSign,{className:"h-10 w-10 text-primary"})}),(0,a.jsx)("h3",{className:"text-2xl font-bold",children:"Become an Affiliate Partner"}),(0,a.jsx)("p",{className:"text-muted-foreground max-w-md",children:"Earn 10% commission for every user you refer to Leli Rentals. Join our affiliate program today and start earning passive income."}),(0,a.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg text-sm text-left w-full space-y-2",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Program Terms:"}),(0,a.jsxs)("ul",{className:"list-disc pl-5 space-y-1",children:[(0,a.jsx)("li",{children:"10% commission on all completed bookings from your referrals."}),(0,a.jsx)("li",{children:"Payouts are processed monthly via Bank Transfer or Mobile Money."}),(0,a.jsx)("li",{children:"Minimum payout threshold: KES 1,000."}),(0,a.jsx)("li",{children:"Spamming or misleading promotion is strictly prohibited."})]})]}),(0,a.jsx)(u.Button,{onClick:S,disabled:C,size:"lg",className:"mt-6",children:C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Joining..."]}):"Agree & Join Program"})]});let A=`https://leli.rentals/signup?ref=${g.invite_code}`;return(0,a.jsxs)("div",{className:"space-y-8 animate-in fade-in duration-500",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Affiliate Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Track your referrals and earnings."})]}),(0,a.jsx)(n.Card,{className:"w-full md:w-auto bg-primary/5 border-primary/20",children:(0,a.jsxs)(n.CardContent,{className:"p-4 flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Your Referral Code"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xl font-mono font-bold",children:g.invite_code}),(0,a.jsx)(u.Button,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>R(g.invite_code),children:_?(0,a.jsx)(m.Check,{className:"h-3 w-3 text-green-500"}):(0,a.jsx)(c.Copy,{className:"h-3 w-3"})})]})]}),(0,a.jsx)(f.Separator,{orientation:"vertical",className:"h-10 mx-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Referral Link"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-foreground/80 truncate max-w-[150px]",children:A}),(0,a.jsx)(u.Button,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>R(A),children:_?(0,a.jsx)(m.Check,{className:"h-3 w-3 text-green-500"}):(0,a.jsx)(c.Copy,{className:"h-3 w-3"})})]})]})]})})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Total Referrals"}),(0,a.jsx)(d.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.CardContent,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:g.total_referrals||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Users signed up"})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Total Earnings"}),(0,a.jsx)(o.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["Kes ",g.total_earnings||0]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Lifetime earnings"})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Pending Payout"}),(0,a.jsx)(o.DollarSign,{className:"h-4 w-4 text-orange-500"})]}),(0,a.jsxs)(n.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-orange-500",children:["Kes ",g.pending_earnings||0]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ready to withdraw"})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Commission Rate"}),(0,a.jsxs)(p.Badge,{variant:"outline",children:[g.commission_rate,"%"]})]}),(0,a.jsxs)(n.CardContent,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[g.commission_rate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Per successful booking"})]})]})]}),(0,a.jsx)("div",{className:"grid gap-4",children:(0,a.jsxs)(n.Card,{className:"col-span-1",children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsx)(n.CardTitle,{children:"Recent Referrals"})}),(0,a.jsx)(n.CardContent,{children:N.length>0?(0,a.jsxs)(h.Table,{children:[(0,a.jsx)(h.TableHeader,{children:(0,a.jsxs)(h.TableRow,{children:[(0,a.jsx)(h.TableHead,{children:"User"}),(0,a.jsx)(h.TableHead,{children:"Date"}),(0,a.jsx)(h.TableHead,{children:"Commission"}),(0,a.jsx)(h.TableHead,{className:"text-right",children:"Status"})]})}),(0,a.jsx)(h.TableBody,{children:N.map(e=>(0,a.jsxs)(h.TableRow,{children:[(0,a.jsx)(h.TableCell,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(j.Avatar,{className:"h-8 w-8",children:[(0,a.jsx)(j.AvatarImage,{src:e.referred_user?.avatar_url}),(0,a.jsx)(j.AvatarFallback,{children:e.referred_user?.full_name?.[0]||"U"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:e.referred_user?.full_name||"Anonymous User"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:e.referred_user?.email})]})]})}),(0,a.jsx)(h.TableCell,{children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsxs)(h.TableCell,{className:"font-medium",children:["Kes ",e.commission_amount]}),(0,a.jsx)(h.TableCell,{className:"text-right",children:(0,a.jsx)(p.Badge,{variant:"paid"===e.commission_status?"default":"secondary",children:e.commission_status})})]},e.id))})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center border rounded-lg border-dashed",children:[(0,a.jsx)(d.Users,{className:"h-8 w-8 text-muted-foreground mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-muted-foreground",children:"No referrals yet"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm mt-2",children:"Share your referral code to start earning commissions!"})]})})]})})]})}e.s(["default",()=>g],73380)}]);