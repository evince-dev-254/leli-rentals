(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70065,e=>{"use strict";var a=e.i(43476),t=e.i(47163);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function r({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function i({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...s})}function n({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...s})}function l({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>l,"CardDescription",()=>n,"CardHeader",()=>r,"CardTitle",()=>i])},95187,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={callServer:function(){return i.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return n.findSourceMapURL}};for(var r in s)Object.defineProperty(t,r,{enumerable:!0,get:s[r]});let i=e.r(32120),n=e.r(92245),l=e.r(35326)},27158,e=>{"use strict";var a=e.i(17927),t=e.i(95187),s=(0,t.createServerReference)("7836f6554c113775f9349130d57af469f4e9914fb6",t.callServer,void 0,t.findSourceMapURL,"sendNewListingEmail");async function r(e){let{data:t,error:s}=await a.supabase.from("listings").select("*").eq("owner_id",e);if(s)throw s;return t}async function i(e){let{count:t,error:s}=await a.supabase.from("listings").select("*",{count:"exact",head:!0}).eq("owner_id",e);if(s)throw s;let{count:r,error:i}=await a.supabase.from("bookings").select("*",{count:"exact",head:!0}).eq("owner_id",e).in("status",["active","confirmed"]);if(i)throw i;let{data:n,error:l}=await a.supabase.from("bookings").select("total_amount").eq("owner_id",e).eq("status","completed");if(l)throw l;let o=n?.reduce((e,a)=>e+(Number(a.total_amount)||0),0)||0,{data:d,error:c}=await a.supabase.from("listings").select("views_count").eq("owner_id",e);if(c)throw c;return{listingsCount:t||0,activeBookingsCount:r||0,totalEarnings:o,totalViews:d?.reduce((e,a)=>e+(Number(a.views_count)||0),0)||0}}async function n(e,t="owner"){let s=a.supabase.from("bookings").select(`
            *,
            listing:listings(title, images),
            renter:user_profiles!bookings_renter_id_fkey(full_name, avatar_url),
            owner:user_profiles!bookings_owner_id_fkey(full_name, avatar_url)
        `).order("created_at",{ascending:!1});s="owner"===t?s.eq("owner_id",e):s.eq("renter_id",e);let{data:r,error:i}=await s;if(i)throw i;return r}async function l(e){let{data:t,error:s}=await a.supabase.from("conversations").select(`
            *,
            listing:listings(title),
            participant1:user_profiles!participant_1_id(full_name, avatar_url),
            participant2:user_profiles!participant_2_id(full_name, avatar_url),
            last_message:messages(content, created_at, is_read, sender_id)
        `).or(`participant_1_id.eq.${e},participant_2_id.eq.${e}`).order("last_message_at",{ascending:!1});if(s)throw s;return t.map(a=>{let t=a.participant_1_id===e?a.participant2:a.participant1,s=a.last_message?.[0]||null;return{...a,otherUser:t,lastMessage:s}})}async function o(e){let{data:t,error:s}=await a.supabase.from("messages").select("*").eq("conversation_id",e).order("created_at",{ascending:!0});if(s)throw s;return t}async function d(e,t,s){let{data:r,error:i}=await a.supabase.from("messages").insert({conversation_id:e,sender_id:t,content:s}).select().single();if(i)throw i;return r}async function c(e){let{data:t,error:s}=await a.supabase.from("verification_documents").select("*").eq("user_id",e);if(s)throw s;return t}async function u(e,t,s,r,i,n){let{data:l,error:o}=await a.supabase.from("verification_documents").insert({user_id:e,document_url:t,back_image_url:s,selfie_image_url:r,document_type:i,document_number:n,status:"pending"}).select().single();if(o)throw o;return l}async function m(e,t){let{data:s,error:r}=await a.supabase.from("user_profiles").update(t).eq("id",e).select().single();if(r)throw r;return s}async function p(e){let{data:t,error:s}=await a.supabase.from("affiliates").select("*").eq("user_id",e).single();if(s&&"PGRST116"!==s.code)throw s;return t||null}async function f(e){let{data:t,error:s}=await a.supabase.from("affiliates").select("id").eq("user_id",e).single();if(s||!t)return[];let{data:r,error:i}=await a.supabase.from("affiliate_referrals").select(`
            id,
            commission_amount,
            commission_status,
            created_at,
            referred_user:user_profiles!referred_user_id(full_name, avatar_url, email)
        `).eq("affiliate_id",t.id).order("created_at",{ascending:!1});if(i)throw i;return r}async function h(e){let{data:t,error:s}=await a.supabase.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(10);if(s)throw s;return t}async function x(e){let{error:t}=await a.supabase.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",e);if(t)throw t}async function g(e,t){console.log("Creating listing with data:",t);let{data:r,error:i}=await a.supabase.from("listings").insert({...t,owner_id:e,views_count:0,favorites_count:0,rating_average:0,rating_count:0,is_featured:!1,is_verified:!1,status:"pending"}).select().single();if(i)throw console.error("Supabase error creating listing:",i),i;console.log("Listing created successfully:",r);try{let{data:t}=await a.supabase.from("user_profiles").select("email, full_name").eq("id",e).single();t?.email&&await s(t.email,t.full_name?.split(" ")[0]||"User",r.title,r.id)}catch(e){console.error("Failed to send listing creation email:",e)}return r}async function v(e){let{data:t,error:s}=await a.supabase.from("bookings").select(`
            id,
            total_amount,
            end_date,
            listing:listings(title)
        `).eq("owner_id",e).eq("status","completed").order("end_date",{ascending:!1});if(s)throw s;return t.map(e=>({id:e.id,type:"earning",desc:e.listing?.title||"Rental",date:new Date(e.end_date).toLocaleDateString(),amount:e.total_amount}))}async function y(e,t,s){let r={status:t};s&&(r.rejection_reason=s);let{error:i}=await a.supabase.from("verification_documents").update(r).eq("id",e);if(i)throw i}async function j(){let{data:e,error:t}=await a.supabase.from("user_profiles").select("*").or("role.eq.admin,is_admin.eq.true");if(t)throw t;return e}async function b(e){let{data:t,error:s}=await a.supabase.from("user_profiles").select("*").eq("email",e).single();if(s)throw s;return t}e.s(["createListing",()=>g,"getAdmins",()=>j,"getAffiliateData",()=>p,"getAffiliateReferrals",()=>f,"getBookings",()=>n,"getConversations",()=>l,"getEarnings",()=>v,"getMessages",()=>o,"getNotifications",()=>h,"getOwnerData",()=>r,"getOwnerStats",()=>i,"getUserByEmail",()=>b,"getVerifications",()=>c,"markNotificationAsRead",()=>x,"sendMessage",()=>d,"updateDocumentStatus",()=>y,"updateProfile",()=>m,"uploadVerification",()=>u],27158)},99682,e=>{"use strict";var a=e.i(71645);function t(e){let t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}e.s(["usePrevious",()=>t])},10708,e=>{"use strict";var a=e.i(43476),t=e.i(71645);e.i(74080);var s=e.i(91918),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let i=(0,s.createSlot)(`Primitive.${r}`),n=t.forwardRef((e,t)=>{let{asChild:s,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(s?i:r,{...n,ref:t})});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{}),i=t.forwardRef((e,t)=>(0,a.jsx)(r.label,{...e,ref:t,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));i.displayName="Label";var n=e.i(47163);function l({className:e,...t}){return(0,a.jsx)(i,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}e.s(["Label",()=>l],10708)},27341,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(81140),r=e.i(30030),i=e.i(42727),n=e.i(96626),l=e.i(48425),o=e.i(86318),d=e.i(69340),c=e.i(10772),u="Tabs",[m,p]=(0,r.createContextScope)(u,[i.createRovingFocusGroupScope]),f=(0,i.createRovingFocusGroupScope)(),[h,x]=m(u),g=t.forwardRef((e,t)=>{let{__scopeTabs:s,value:r,onValueChange:i,defaultValue:n,orientation:m="horizontal",dir:p,activationMode:f="automatic",...x}=e,g=(0,o.useDirection)(p),[v,y]=(0,d.useControllableState)({prop:r,onChange:i,defaultProp:n??"",caller:u});return(0,a.jsx)(h,{scope:s,baseId:(0,c.useId)(),value:v,onValueChange:y,orientation:m,dir:g,activationMode:f,children:(0,a.jsx)(l.Primitive.div,{dir:g,"data-orientation":m,...x,ref:t})})});g.displayName=u;var v="TabsList",y=t.forwardRef((e,t)=>{let{__scopeTabs:s,loop:r=!0,...n}=e,o=x(v,s),d=f(s);return(0,a.jsx)(i.Root,{asChild:!0,...d,orientation:o.orientation,dir:o.dir,loop:r,children:(0,a.jsx)(l.Primitive.div,{role:"tablist","aria-orientation":o.orientation,...n,ref:t})})});y.displayName=v;var j="TabsTrigger",b=t.forwardRef((e,t)=>{let{__scopeTabs:r,value:n,disabled:o=!1,...d}=e,c=x(j,r),u=f(r),m=_(c.baseId,n),p=k(c.baseId,n),h=n===c.value;return(0,a.jsx)(i.Item,{asChild:!0,...u,focusable:!o,active:h,children:(0,a.jsx)(l.Primitive.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":p,"data-state":h?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:m,...d,ref:t,onMouseDown:(0,s.composeEventHandlers)(e.onMouseDown,e=>{o||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(n)}),onKeyDown:(0,s.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(n)}),onFocus:(0,s.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==c.activationMode;h||o||!e||c.onValueChange(n)})})})});b.displayName=j;var w="TabsContent",N=t.forwardRef((e,s)=>{let{__scopeTabs:r,value:i,forceMount:o,children:d,...c}=e,u=x(w,r),m=_(u.baseId,i),p=k(u.baseId,i),f=i===u.value,h=t.useRef(f);return t.useEffect(()=>{let e=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,a.jsx)(n.Presence,{present:o||f,children:({present:t})=>(0,a.jsx)(l.Primitive.div,{"data-state":f?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!t,id:p,tabIndex:0,...c,ref:s,style:{...e.style,animationDuration:h.current?"0s":void 0},children:t&&d})})});function _(e,a){return`${e}-trigger-${a}`}function k(e,a){return`${e}-content-${a}`}N.displayName=w;var C=e.i(47163);function S({className:e,...t}){return(0,a.jsx)(g,{"data-slot":"tabs",className:(0,C.cn)("flex flex-col gap-2",e),...t})}function P({className:e,...t}){return(0,a.jsx)(y,{"data-slot":"tabs-list",className:(0,C.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function T({className:e,...t}){return(0,a.jsx)(b,{"data-slot":"tabs-trigger",className:(0,C.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function R({className:e,...t}){return(0,a.jsx)(N,{"data-slot":"tabs-content",className:(0,C.cn)("flex-1 outline-none",e),...t})}e.s(["Tabs",()=>S,"TabsContent",()=>R,"TabsList",()=>P,"TabsTrigger",()=>T],27341)},61659,e=>{"use strict";let a=(0,e.i(75254).default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>a],61659)},98919,e=>{"use strict";let a=(0,e.i(75254).default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);e.s(["Shield",()=>a],98919)},7233,e=>{"use strict";let a=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],7233)},27612,e=>{"use strict";let a=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>a],27612)},69035,e=>{"use strict";var a=e.i(43476),t=e.i(71645);e.i(74080);var s=e.i(91918),r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let i=(0,s.createSlot)(`Primitive.${r}`),n=t.forwardRef((e,t)=>{let{asChild:s,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(s?i:r,{...n,ref:t})});return n.displayName=`Primitive.${r}`,{...e,[r]:n}},{}),i="horizontal",n=["horizontal","vertical"],l=t.forwardRef((e,t)=>{var s;let{decorative:l,orientation:o=i,...d}=e,c=(s=o,n.includes(s))?o:i;return(0,a.jsx)(r.div,{"data-orientation":c,...l?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...d,ref:t})});l.displayName="Separator";var o=e.i(47163);function d({className:e,orientation:t="horizontal",decorative:s=!0,...r}){return(0,a.jsx)(l,{"data-slot":"separator",decorative:s,orientation:t,className:(0,o.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}e.s(["Separator",()=>d],69035)},86536,e=>{"use strict";let a=(0,e.i(75254).default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>a],86536)},77705,e=>{"use strict";let a=(0,e.i(75254).default)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["EyeOff",()=>a],77705)},48256,e=>{"use strict";let a=(0,e.i(75254).default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);e.s(["Globe",()=>a],48256)},56909,19036,e=>{"use strict";let a=(0,e.i(75254).default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>a],56909);var t=e.i(43476),s=e.i(71645),r=e.i(81140),i=e.i(20783),n=e.i(30030),l=e.i(69340),o=e.i(99682),d=e.i(35804),c=e.i(48425),u="Switch",[m,p]=(0,n.createContextScope)(u),[f,h]=m(u),x=s.forwardRef((e,a)=>{let{__scopeSwitch:n,name:o,checked:d,defaultChecked:m,required:p,disabled:h,value:x="on",onCheckedChange:g,form:v,...b}=e,[w,N]=s.useState(null),_=(0,i.useComposedRefs)(a,e=>N(e)),k=s.useRef(!1),C=!w||v||!!w.closest("form"),[S,P]=(0,l.useControllableState)({prop:d,defaultProp:m??!1,onChange:g,caller:u});return(0,t.jsxs)(f,{scope:n,checked:S,disabled:h,children:[(0,t.jsx)(c.Primitive.button,{type:"button",role:"switch","aria-checked":S,"aria-required":p,"data-state":j(S),"data-disabled":h?"":void 0,disabled:h,value:x,...b,ref:_,onClick:(0,r.composeEventHandlers)(e.onClick,e=>{P(e=>!e),C&&(k.current=e.isPropagationStopped(),k.current||e.stopPropagation())})}),C&&(0,t.jsx)(y,{control:w,bubbles:!k.current,name:o,value:x,checked:S,required:p,disabled:h,form:v,style:{transform:"translateX(-100%)"}})]})});x.displayName=u;var g="SwitchThumb",v=s.forwardRef((e,a)=>{let{__scopeSwitch:s,...r}=e,i=h(g,s);return(0,t.jsx)(c.Primitive.span,{"data-state":j(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:a})});v.displayName=g;var y=s.forwardRef(({__scopeSwitch:e,control:a,checked:r,bubbles:n=!0,...l},c)=>{let u=s.useRef(null),m=(0,i.useComposedRefs)(u,c),p=(0,o.usePrevious)(r),f=(0,d.useSize)(a);return s.useEffect(()=>{let e=u.current;if(!e)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(p!==r&&a){let t=new Event("click",{bubbles:n});a.call(e,r),e.dispatchEvent(t)}},[p,r,n]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...l,tabIndex:-1,ref:m,style:{...l.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function j(e){return e?"checked":"unchecked"}y.displayName="SwitchBubbleInput";var b=e.i(47163);function w({className:e,...a}){return(0,t.jsx)(x,{"data-slot":"switch",className:(0,b.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...a,children:(0,t.jsx)(v,{"data-slot":"switch-thumb",className:"bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"})})}e.s(["Switch",()=>w],19036)},94962,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(56909),r=e.i(45423),i=e.i(98919),n=e.i(61659),l=e.i(48256);let o=(0,e.i(75254).default)("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);var d=e.i(7233),c=e.i(27612),u=e.i(55436),m=e.i(86536),p=e.i(77705),f=e.i(31278),h=e.i(70065),x=e.i(23750),g=e.i(67881),v=e.i(10708),y=e.i(19036),j=e.i(69035),b=e.i(27341),w=e.i(63270),N=e.i(27158),_=e.i(46696),k=e.i(17927);function C(){let[e,C]=(0,t.useState)([]),[S,P]=(0,t.useState)(""),[T,R]=(0,t.useState)(!0),[L,E]=(0,t.useState)(null),[M,q]=(0,t.useState)({}),[D,I]=(0,t.useState)(!0),[F,A]=(0,t.useState)(!1),[V,z]=(0,t.useState)(!1),[U,B]=(0,t.useState)(!1),[O,H]=(0,t.useState)(""),[$,K]=(0,t.useState)("");(0,t.useEffect)(()=>{Y(),G(),X()},[]);let G=async()=>{let{data:{user:e}}=await k.supabase.auth.getUser();e&&E(e.email??null)},W=async()=>{if(!O||O.length<6)return void _.toast.error("Password must be at least 6 characters");if(O!==$)return void _.toast.error("Passwords do not match");try{let{error:e}=await k.supabase.auth.updateUser({password:O});if(e)throw e;_.toast.success("Password updated successfully"),H(""),K("")}catch(e){console.error("Error updating password:",e),_.toast.error(e.message||"Failed to update password")}},Y=async()=>{try{let e=await (0,N.getAdmins)();C(e||[])}catch(e){console.error("Error loading admins:",e),_.toast.error("Failed to load admins")}finally{R(!1)}},X=async()=>{try{I(!0);let{data:e,error:a}=await k.supabase.from("admin_settings").select("*");if(a)throw a;let t={};e?.forEach(e=>{t[e.key]=e.value}),q(t)}catch(e){console.error("Error loading settings:",e)}finally{I(!1)}},J=(e,a)=>{q(t=>({...t,[e]:a}))},Q=async()=>{try{A(!0);let e=Object.entries(M).map(([e,a])=>({key:e,value:a,updated_at:new Date().toISOString()})),{error:a}=await k.supabase.from("admin_settings").upsert(e);if(a)throw a;_.toast.success("Settings saved successfully")}catch(e){console.error("Error saving settings:",e),_.toast.error("Failed to save settings")}finally{A(!1)}},Z=async()=>{if(S)try{let e=await (0,N.getUserByEmail)(S);if(!e)return void _.toast.error("User with this email not found");if(e.is_admin||"admin"===e.role){_.toast.info("User is already an admin"),P("");return}await (0,N.updateProfile)(e.id,{is_admin:!0}),_.toast.success(`${e.email} promoted to admin`),P(""),Y()}catch(e){console.error("Error adding admin:",e),_.toast.error("Failed to add admin")}},ee=async(a,t)=>{if(t===L)return void _.toast.error("You cannot remove yourself from admins");if(confirm(`Are you sure you want to remove admin rights from ${t}?`))try{let s=e.find(e=>e.id===a),r={is_admin:!1};s?.role==="admin"&&(r.role="renter"),await (0,N.updateProfile)(a,r),_.toast.success(`${t} removed from admins`),Y()}catch(e){console.error("Error removing admin:",e),_.toast.error("Failed to remove admin")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Settings"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Configure platform settings and preferences"})]}),(0,a.jsxs)(b.Tabs,{defaultValue:"general",className:"space-y-4",children:[(0,a.jsxs)(b.TabsList,{children:[(0,a.jsx)(b.TabsTrigger,{value:"general",children:"General"}),(0,a.jsx)(b.TabsTrigger,{value:"security",children:"Security"}),(0,a.jsx)(b.TabsTrigger,{value:"admins",children:"Admins"}),(0,a.jsx)(b.TabsTrigger,{value:"verification",children:"Verification"}),(0,a.jsx)(b.TabsTrigger,{value:"notifications",children:"Notifications"}),(0,a.jsx)(b.TabsTrigger,{value:"payments",children:"Payments"})]}),(0,a.jsx)(b.TabsContent,{value:"security",children:(0,a.jsxs)(h.Card,{className:"glass-card",children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(i.Shield,{className:"h-5 w-5"}),"Security"]}),(0,a.jsx)(h.CardDescription,{children:"Manage your account security"})]}),(0,a.jsx)(h.CardContent,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Change Password"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update your password to keep your account secure."}),(0,a.jsxs)("div",{className:"grid gap-4 max-w-md",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"admin-new-password",children:"New Password"}),(0,a.jsx)(x.Input,{id:"admin-new-password",type:"password",placeholder:"Enter new password",value:O,onChange:e=>H(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"admin-confirm-password",children:"Confirm Password"}),(0,a.jsx)(x.Input,{id:"admin-confirm-password",type:"password",placeholder:"Confirm new password",value:$,onChange:e=>K(e.target.value)})]}),(0,a.jsx)(g.Button,{onClick:W,disabled:!O||!$,children:"Update Password"})]})]})})]})}),(0,a.jsx)(b.TabsContent,{value:"general",children:(0,a.jsxs)(h.Card,{className:"glass-card",children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(l.Globe,{className:"h-5 w-5"}),"General Settings"]}),(0,a.jsx)(h.CardDescription,{children:"Basic platform configuration"})]}),(0,a.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"site-name",children:"Site Name"}),(0,a.jsx)(x.Input,{id:"site-name",value:M.site_name||"",onChange:e=>J("site_name",e.target.value),placeholder:"Leli Rentals"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"support-email",children:"Support Email"}),(0,a.jsx)(x.Input,{id:"support-email",value:M.support_email||"",onChange:e=>J("support_email",e.target.value),placeholder:"support@lelirentals.com"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"support-phone",children:"Support Phone"}),(0,a.jsx)(x.Input,{id:"support-phone",value:M.support_phone||"",onChange:e=>J("support_phone",e.target.value),placeholder:"+254..."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"default-currency",children:"Default Currency"}),(0,a.jsx)(x.Input,{id:"default-currency",value:M.default_currency||"",onChange:e=>J("default_currency",e.target.value),placeholder:"KSh"})]})]}),(0,a.jsxs)(g.Button,{onClick:Q,disabled:F,className:"bg-primary text-primary-foreground",children:[F?(0,a.jsx)(f.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(s.Save,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})}),(0,a.jsx)(b.TabsContent,{value:"admins",children:(0,a.jsxs)(h.Card,{className:"glass-card",children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(o,{className:"h-5 w-5"}),"Manage Admins"]}),(0,a.jsx)(h.CardDescription,{children:"View and manage administrators with access to this dashboard"})]}),(0,a.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"new-admin-email",children:"Add New Admin"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(x.Input,{id:"new-admin-email",placeholder:"Enter user email address...",className:"pl-10",value:S,onChange:e=>P(e.target.value)})]})]}),(0,a.jsxs)(g.Button,{onClick:Z,disabled:!S,children:[(0,a.jsx)(d.Plus,{className:"h-4 w-4 mr-2"}),"Add Admin"]})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Current Admins"}),T?(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading admins..."}):(0,a.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border border-border bg-card/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(w.Avatar,{children:[(0,a.jsx)(w.AvatarImage,{src:e.avatar_url||void 0}),(0,a.jsx)(w.AvatarFallback,{children:e.full_name?.split(" ").map(e=>e[0]).join("")||"U"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.full_name||"Unknown Name"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[e.email===L&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground bg-secondary px-2 py-1 rounded",children:"You"}),(0,a.jsx)(g.Button,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>ee(e.id,e.email),disabled:e.email===L,children:(0,a.jsx)(c.Trash2,{className:"h-4 w-4"})})]})]},e.id))})]})]})]})}),(0,a.jsx)(b.TabsContent,{value:"verification",children:(0,a.jsxs)(h.Card,{className:"glass-card",children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(i.Shield,{className:"h-5 w-5"}),"Verification Settings"]}),(0,a.jsx)(h.CardDescription,{children:"Configure user verification requirements"})]}),(0,a.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Require Owner Verification"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Owners must submit documents before listing items"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Require Affiliate Verification"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Affiliates must verify identity before earning commissions"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"verification-deadline",children:"Verification Deadline (Days)"}),(0,a.jsx)(x.Input,{id:"verification-deadline",type:"number",defaultValue:"5",className:"w-32"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Days allowed for document submission before account suspension"})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Auto-suspend on Deadline"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Automatically suspend accounts that miss verification deadline"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]})]}),(0,a.jsxs)(g.Button,{onClick:()=>_.toast.success("Verification settings saved"),className:"bg-primary text-primary-foreground",children:[(0,a.jsx)(s.Save,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})}),(0,a.jsx)(b.TabsContent,{value:"notifications",children:(0,a.jsxs)(h.Card,{className:"glass-card",children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Bell,{className:"h-5 w-5"}),"Notification Settings"]}),(0,a.jsx)(h.CardDescription,{children:"Configure email and system notifications"})]}),(0,a.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"New User Registration"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Notify admin when new users register"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Verification Document Submitted"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Notify when documents are uploaded"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Verification Deadline Warning"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Send reminder emails before deadline"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Account Suspension"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Notify when accounts are suspended"})]}),(0,a.jsx)(y.Switch,{defaultChecked:!0})]})]}),(0,a.jsxs)(g.Button,{onClick:()=>_.toast.success("Notification settings saved"),className:"bg-primary text-primary-foreground",children:[(0,a.jsx)(s.Save,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})}),(0,a.jsx)(b.TabsContent,{value:"payments",children:(0,a.jsxs)(h.Card,{className:"glass-card",children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(n.CreditCard,{className:"h-5 w-5"}),"Payment Settings"]}),(0,a.jsx)(h.CardDescription,{children:"Configure Paystack and subscription plans"})]}),(0,a.jsxs)(h.CardContent,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"paystack-public",children:"Paystack Public Key"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.Input,{id:"paystack-public",type:V?"text":"password",value:M.paystack_public_key||"",onChange:e=>J("paystack_public_key",e.target.value),placeholder:"pk_live_...",className:"pr-10"}),(0,a.jsxs)(g.Button,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>z(!V),children:[V?(0,a.jsx)(p.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,a.jsx)(m.Eye,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle public key visibility"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"paystack-secret",children:"Paystack Secret Key"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.Input,{id:"paystack-secret",type:U?"text":"password",value:M.paystack_secret_key||"",onChange:e=>J("paystack_secret_key",e.target.value),placeholder:"sk_live_...",className:"pr-10"}),(0,a.jsxs)(g.Button,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>B(!U),children:[U?(0,a.jsx)(p.EyeOff,{className:"h-4 w-4 text-muted-foreground"}):(0,a.jsx)(m.Eye,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle secret key visibility"})]})]})]})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Subscription Plans"}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"p-4 rounded-lg border border-border space-y-3",children:[(0,a.jsx)("p",{className:"font-medium",children:"Weekly Plan"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"weekly-price",children:"Price (KSh)"}),(0,a.jsx)(x.Input,{id:"weekly-price",type:"number",value:M.weekly_plan_price||"500",onChange:e=>J("weekly_plan_price",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"weekly-listings",children:"Listing Limit"}),(0,a.jsx)(x.Input,{id:"weekly-listings",type:"number",value:M.weekly_plan_limit||"10",onChange:e=>J("weekly_plan_limit",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"p-4 rounded-lg border border-border space-y-3",children:[(0,a.jsx)("p",{className:"font-medium",children:"Monthly Plan"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"monthly-price",children:"Price (KSh)"}),(0,a.jsx)(x.Input,{id:"monthly-price",type:"number",value:M.monthly_plan_price||"1000",onChange:e=>J("monthly_plan_price",e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"monthly-listings",children:"Listing Limit"}),(0,a.jsx)(x.Input,{id:"monthly-listings",value:M.monthly_plan_limit||"Unlimited",onChange:e=>J("monthly_plan_limit",e.target.value)})]})]})]})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v.Label,{htmlFor:"affiliate-commission",children:"Affiliate Commission Rate (%)"}),(0,a.jsx)(x.Input,{id:"affiliate-commission",type:"number",value:M.affiliate_commission_rate||"15",onChange:e=>J("affiliate_commission_rate",e.target.value),className:"w-32"})]}),(0,a.jsxs)(g.Button,{onClick:Q,disabled:F,className:"bg-primary text-primary-foreground",children:[F?(0,a.jsx)(f.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(s.Save,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})})]})]})}e.s(["AdminSettings",()=>C],94962)}]);